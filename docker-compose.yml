version: '3.8'

services:
  api:
    image: restaurantapi:latest
    ports:
      - "5001:80"  # Mapea el puerto 80 del contenedor al 5000 del host
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ASPNETCORE_URLS=http://+:80  # Solo HTTP
      - MongoDbSettings__ConnectionString=mongodb://mongoadmin:secret@mongodb:27017/admin?authSource=admin
      - MongoDbSettings__DatabaseName=RestaurantDb
      - JwtSettings__SecretKey=secretKey
      - JwtSettings__Issuer=issuer
      - JwtSettings__Audience=audience
      - JwtSettings__TokenSessionExpiration=30
      - JwtSettings__TokenRefreshExpiration=1440
      - InitialValue__Establishment__Name=Restaurante
      - InitialValue__Establishment__Descrption=Descripci√≥n
      - InitialValue__Establishment__Token=token
      - InitialValue__Establishment__Address=-
      - InitialValue__Establishment__Phone=-
      - InitialValue__Establishment__Logo=-
      - InitialValue__Establishment__Email=
      - InitialValue__Administrator__Name=Administrador
      - InitialValue__Administrator__Username=admin
      - InitialValue__Administrator__Password=admin
    # depends_on:
    #   - mongodb

  mongodb:
    image: mongo:6.0
    container_name: mongodb
    ports:
      - "27018:27017"
    environment:
      MONGO_INITDB_ROOT_USERNAME: mongoadmin
      MONGO_INITDB_ROOT_PASSWORD: secret
    volumes:
      - mongodb_data:/data/db

volumes:
  mongodb_data: